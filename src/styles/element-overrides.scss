@use './theme.scss' as theme;

// Centralized Dark Theme Overrides for Element Plus Components

// 1. Dark Table Style
.dark-table {
  // Use CSS variables to override Element Plus defaults
  --el-table-bg-color: transparent;
  --el-table-tr-bg-color: transparent;
  --el-table-header-bg-color: transparent;
  --el-table-border-color: #{theme.$border-color};
  --el-table-row-hover-bg-color: #{rgba(theme.$primary-accent-color, 0.08)};
  // 修正：Element Plus 使用的真正变量名是 --el-fill-color-lighter
  --el-fill-color-lighter: #{rgba(255, 255, 255, 0.05)};
  // 高亮当前行（可选）
  --el-table-current-row-bg-color: #{rgba(theme.$primary-accent-color, 0.12)};
  
  .el-table__header-wrapper th {
    color: theme.$title-color;
    background-color: transparent !important;
  }

  .el-table__row {
    color: theme.$text-color;
  }
  
  .el-table__row td.el-table__cell {
    background-color: transparent;
  }

  // This is a fallback for older versions, the CSS variable is preferred.
  &.el-table--striped .el-table__body tr.el-table__row--striped td.el-table__cell {
    background-color: rgba(255, 255, 255, 0.05) !important;
  }
}

// 2. Dark Menu Style (for vertical side menus)
.dark-menu {
  background-color: transparent;
  border-right: 1px solid theme.$border-color;
  .el-menu-item {
    color: theme.$text-color;
    &:hover {
      background-color: theme.$left-menu-active-bg;
    }
    &.is-active {
      color: theme.$primary-accent-color;
      background-color: theme.$left-menu-active-bg;
    }
  }
}

// 3. Dark Tree Style
.dark-tree {
  background-color: transparent;
  color: theme.$text-color;
  --el-tree-node-hover-bg-color: #{theme.$left-menu-active-bg};
  
  .el-tree-node__content:hover {
    background-color: var(--el-tree-node-hover-bg-color);
  }

  .el-tree-node:focus > .el-tree-node__content {
    background-color: var(--el-tree-node-hover-bg-color);
  }

  .el-checkbox__inner {
    background-color: transparent;
    border: 1px solid theme.$border-color;
  }
}

// 4. Dark Form Style
.dark-form {
  padding: 10px;
  .el-form-item__label {
    color: theme.$text-color;
  }
  .el-input__wrapper, .el-textarea__inner {
    background-color: rgba(0, 0, 0, 0.2);
    box-shadow: none;
    border: 1px solid theme.$border-color;
    color: theme.$text-color;
  }
}

// 5. Global Overlay & Popper Styles
// A comprehensive set of rules to style all floating elements like dropdowns, dialogs, etc.
// These need to be global as they are teleported to the end of <body>.

// For all Dropdowns (user menu, notifications, analysis menu)
.el-dropdown__popper {
  background: #{theme.$left-menu-bg} !important;
  border: 1px solid theme.$border-color !important;

  .el-dropdown-menu__item {
    color: theme.$text-color !important;
    font-size: 16px !important; // Match top-level menu
    padding: 10px 20px !important; // Add vertical padding
    &:hover {
      background-color: #{theme.$left-menu-active-bg} !important;
      color: #fff !important;
    }
  }
  .el-popper__arrow::before {
    background: #{theme.$left-menu-bg} !important;
    border-color: theme.$border-color !important;
  }
}

// For all Select dropdowns (filters in tables etc.)
.el-select-dropdown {
  background: #{theme.$left-menu-bg} !important;
  border: 1px solid theme.$border-color !important;

  .el-select-dropdown__item {
    color: theme.$text-color !important;
    &.hover, &:hover {
      background-color: #{theme.$left-menu-active-bg} !important;
    }
    &.selected {
       color: #{theme.$primary-accent-color} !important;
       font-weight: bold;
    }
  }
}

// For all Dialogs (add/edit modals)
.el-dialog {
  background-color: #{theme.$panel-bg-color} !important;
  border: 1px solid #{theme.$border-color};

  .el-dialog__header {
    padding-bottom: 10px;
    margin-right: 0;
    border-bottom: 1px solid #{theme.$border-color};
  }
  .el-dialog__title {
     color: theme.$title-color;
  }
   .el-dialog__headerbtn .el-dialog__close {
    color: theme.$text-color;
    font-size: 20px;
    &:hover {
      color: theme.$primary-accent-color;
    }
  }
}

// For all Message Boxes (confirmation dialogs)
.el-message-box {
    background-color: #{theme.$panel-bg-color} !important;
    border: 1px solid #{theme.$border-color} !important;

    .el-message-box__title {
        color: theme.$title-color;
    }
    .el-message-box__content {
        color: theme.$text-color;
    }
} 