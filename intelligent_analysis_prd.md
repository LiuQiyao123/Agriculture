# 智能分析决策模块 - 产品需求文档 (PRD)

## 模块总览

基于深渡智慧农业平台的AI分析能力，智能分析决策模块包含7个核心子模块，突出AI预测分析能力，为政府农业管理提供科学决策支持。

---

## 3.3.1 墒情监测与旱情分析

### 页面目标
基于AI算法融合多源数据，实现区域墒情智能监测、干旱风险预测和抗旱决策支持。

### 核心功能设计

#### 1. 筛选器区域
- **时间范围选择器**：支持快捷选项（近7天/近30天/近90天）和自定义日期范围
- **区域筛选**：乡镇多选下拉框，支持全选/反选
- **监测深度选择**：0-20cm/20-40cm/40-100cm土壤深度选择
- **AI预测开关**：开启后显示未来7天旱情发展预测

#### 2. 核心可视化布局
**顶部：** 筛选器 + 关键指标卡片
**中部：** GIS地图（70%宽度）+ 右侧数据面板（30%宽度）
**底部：** 详细数据图表区

#### 3. 关键指标卡片（4个）
- **当前平均墒情**：xx% <span style="color:green">▲2.1%（较上周）</span>
- **旱情预警地块**：xxx个 <span style="color:red">高风险45个</span>
- **AI预测准确率**：xx% <span style="color:lime">模型置信度</span>
- **需灌溉面积预测**：xx万亩 <span style="color:orange">未来7天预测</span>

#### 4. GIS地图功能
- **墒情分级渲染**：
  - 过湿(>85%)：深蓝色 `#1e3a8a`
  - 适宜(60-85%)：绿色 `#16a34a`
  - 轻旱(40-60%)：黄色 `#ca8a04`
  - 中旱(20-40%)：橙色 `#ea580c`
  - 重旱(<20%)：红色 `#dc2626`
- **AI预测图层**：开启预测模式后，地图显示未来7天旱情发展趋势动画
- **地块详情弹窗**：点击地块显示详细墒情数据、历史变化曲线、AI预测结果

#### 5. 右侧数据面板
- **默认状态**：显示全县各乡镇平均土壤湿度柱状图
- **选择地块后**：切换为该地块的"近30天土壤湿度变化"折线图，标注最高/最低值和AI预测趋势

#### 6. AI智能分析功能
- **旱情发展预测**：基于气象预报、土壤类型、历史数据预测旱情发展
- **灌溉建议生成**：AI推荐最佳灌溉时间和用水量
- **异常预警**：自动识别墒情异常变化的地块并发送预警

---

## 3.3.2 作物长势遥感监测

### 页面目标
通过AI分析遥感NDVI数据，智能评估作物长势，提供产量预测和管理建议。

### 核心功能设计

#### 1. 筛选器区域
- **时间点选择器**：选择遥感数据采集日期，支持时间轴滑动
- **乡镇筛选**：多选下拉框
- **作物类型筛选**：水稻/小麦/玉米/大豆等
- **AI分析模式**：长势评估/产量预测/异常检测

#### 2. 核心可视化布局
**左侧：** GIS地图（60%宽度）
**右侧：** 数据分析区（40%宽度）

#### 3. 关键指标卡片（4个）
- **平均NDVI值**：0.xx <span style="color:green">较上期+0.05</span>
- **长势优良率**：xx% <span style="color:lime">优等地块占比</span>
- **异常地块数**：xx个 <span style="color:red">AI自动识别</span>
- **预测减产风险**：xx% <span style="color:orange">基于长势趋势</span>

#### 4. GIS地图功能
- **NDVI分级渲染**：
  - 优(>0.8)：深绿色 `#166534`
  - 良(0.6-0.8)：绿色 `#16a34a`
  - 中(0.4-0.6)：黄绿色 `#65a30d`
  - 差(<0.4)：黄色 `#ca8a04`
- **多地块对比功能**：支持选择最多4个地块进行长势对比
- **时序动画**：播放不同时期NDVI变化动画，展示长势发展过程

#### 5. 右侧数据分析区
- **长势对比分析面板**：每选择一个地块，动态添加一个卡片
- **地块卡片内容**：地块名称 + mini折线图（近3个季度NDVI变化）
- **AI诊断报告**：文本形式的长势分析和管理建议
- **产量预测图表**：基于长势数据预测该地块的产量水平

#### 6. AI智能分析功能
- **长势智能评估**：AI综合分析NDVI、气象、土壤等数据评估长势等级
- **异常地块自动识别**：检测长势突然下降或异常的地块
- **产量预测模型**：基于长势趋势预测最终产量
- **管理建议生成**：针对不同长势等级自动生成管理建议

---

## 3.3.3 土地用途分析

### 页面目标
可视化展示全县土地资源利用现状，支持历史追溯，为国土规划提供数据支撑。

### 核心功能设计

#### 1. 筛选器区域
- **年份对比选择器**：当前年份 vs 对比年份（如2025 vs 2020）
- **乡镇筛选**：多选下拉框
- **土地类型筛选**：耕地/林地/草地/建设用地/水域等
- **分析维度**：面积变化/用途转换/利用效率

#### 2. 核心可视化布局
**左侧：** GIS地图（65%宽度）
**右侧：** 统计分析面板（35%宽度）

#### 3. 关键指标卡片（4个）
- **耕地保有量**：xx万亩 <span style="color:green">完成率102%</span>
- **建设用地增量**：xx亩 <span style="color:orange">较去年+5.2%</span>
- **土地利用率**：xx% <span style="color:lime">高于全市平均</span>
- **违规用地发现**：xx处 <span style="color:red">AI自动识别</span>

#### 4. GIS地图功能
- **土地用途分色渲染**：
  - 耕地：绿色 `#16a34a`
  - 林地：深绿色 `#166534`  
  - 草地：浅绿色 `#84cc16`
  - 建设用地：灰色 `#6b7280`
  - 水域：蓝色 `#2563eb`
- **变化对比模式**：支持切换显示不同年份的土地用途分布
- **违规用地标注**：AI识别的疑似违规用地用红色边框标注

#### 5. 右侧统计面板
- **面板1：土地利用结构玫瑰图**：各类土地用途的面积占比
- **面板2：耕地变化趋势柱状图**：各乡镇耕地面积年际对比
- **面板3：用途转换流向图**：展示土地用途之间的转换关系
- **面板4：利用效率评估表**：各类土地的利用效率评分

#### 6. AI智能分析功能
- **土地用途智能识别**：基于遥感影像AI识别土地实际用途
- **违规用地自动发现**：对比规划用途与实际用途，发现违规问题
- **用途变化预测**：预测土地用途变化趋势
- **优化建议生成**：为土地规划和管理提供AI建议

---

## 3.3.4 耕地退化分析

### 页面目标
AI识别耕地退化风险，分析退化成因，为土壤改良提供科学指导。

### 核心功能设计

#### 1. 筛选器区域
- **退化类型选择**：土壤酸化/养分流失/土壤盐碱化/重金属污染
- **年份对比**：当前年份 vs 历史基准年份
- **风险等级筛选**：高风险/中风险/低风险/全部
- **分析模型选择**：综合评估模型/单因子分析模型

#### 2. 核心可视化布局
**主体：** GIS地图（70%宽度）
**右侧：** 数据分析面板（30%宽度）

#### 3. 关键指标卡片（4个）
- **高风险耕地**：xx万亩 <span style="color:red">占总耕地x%</span>
- **平均退化指数**：x.xx <span style="color:orange">较去年+0.05</span>
- **治理成效评估**：xx% <span style="color:green">已治理地块改善率</span>
- **预估治理投入**：xx万元 <span style="color:blue">基于AI模型测算</span>

#### 4. GIS地图功能
- **退化风险分级渲染**：
  - 高风险(指数>0.7)：红色 `#dc2626`
  - 中风险(0.4-0.7)：橙色 `#ea580c`
  - 低风险(<0.4)：黄色 `#ca8a04`
  - 健康：绿色 `#16a34a`
- **退化因子叠加**：可选择显示pH值、有机质含量等单一因子分布
- **治理效果对比**：对比治理前后的退化指数变化

#### 5. 右侧数据面板
- **风险等级统计**：高、中、低风险耕地的面积及占比
- **退化趋势图**：近10年平均退化指数变化趋势
- **高风险地块列表**：风险最高的10个地块，点击可定位
- **成因分析图表**：不同退化因子的贡献度分析

#### 6. AI智能分析功能
- **退化程度智能评估**：综合多种指标AI计算退化指数
- **成因智能诊断**：分析导致退化的主要原因
- **治理方案推荐**：针对不同退化类型推荐治理措施
- **效果预测模型**：预测治理措施的预期效果

---

## 3.3.5 产量与产值预测

### 页面目标
整合多源数据，AI预测农业产量产值，为生产规划和市场决策提供支撑。

### 核心功能设计

#### 1. 筛选器区域
- **预测周期**：当季/下季/全年
- **作物类型**：主要粮食作物和经济作物
- **乡镇范围**：支持单选和多选
- **预测模型**：短期模型/中期模型/长期趋势模型

#### 2. 核心可视化布局
**类仪表盘布局**：
**顶部：** 核心预测总览卡片区
**中部：** 多维度分析图表区
**底部：** 详细数据表格区

#### 3. 核心预测卡片（4个）
- **预估总产量**：xx万吨 <span style="color:green">同比+8.2%</span>
- **预估总产值**：xx亿元 <span style="color:lime">环比+5.6%</span>
- **平均亩产预测**：xxx公斤/亩 <span style="color:blue">高于全省平均</span>
- **模型预测精度**：xx% <span style="color:gray">基于历史验证</span>

#### 4. 多维度分析图表
- **产量分布柱状图**：各乡镇预估产量对比，支持与去年同期对比
- **预测修正历史图**：展示从播种期到收获期预测值的动态调整过程
- **产值构成饼图**：不同作物对总产值的贡献占比
- **价格趋势预测图**：结合市场分析预测农产品价格走势

#### 5. 详细数据表格
包含各乡镇的：
- 种植面积（亩）
- 预估亩产（公斤）
- 预估总产量（吨）
- 市场均价预测（元/公斤）
- 预估产值（万元）
- 置信区间范围

#### 6. AI智能分析功能
- **多因子产量预测**：综合气象、土壤、长势、管理水平等因素
- **市场价格预测**：分析供需关系预测价格走势
- **风险评估模型**：评估影响产量的各种风险因子
- **优化建议生成**：提供增产增收的管理建议

---

## 3.3.6 智慧灌溉数字孪生

### 页面目标
通过高保真3D场景，全过程模拟智能灌溉系统，展示AI驱动的精准农业技术。

### 核心功能设计

#### 1. 场景选择区域
- **示范区选择**：预设的3-5个不同类型示范农田
- **作物类型**：水稻/小麦/蔬菜等不同作物的灌溉场景
- **季节模式**：春播/夏管/秋收不同季节的灌溉需求
- **天气模式**：晴天/雨天/干旱等不同天气条件

#### 2. 全屏沉浸式3D场景
使用Three.js构建，包含：
- **地块微地形**：真实的田间地形起伏
- **作物3D模型**：不同生长期的作物建模
- **灌溉设施模型**：喷灌系统、滴灌管道、阀门控制器
- **传感器设备模型**：土壤传感器、气象站、摄像头等
- **水流粒子效果**：逼真的灌溉水流动画

#### 3. HUD面板1：环境监测（左上角）
- **气象数据仪表盘**：
  - 空气温度：xx℃
  - 空气湿度：xx%
  - 风速：xx m/s
  - 光照强度：xx lux
- **土壤数据网格**：9个分区的实时土壤湿度读数

#### 4. HUD面板2：灌溉控制（右侧）
- **控制模式选择**：
  - 智能决策模式（AI自动执行）
  - 定时定量模式
  - 手动控制模式
- **AI策略选择**：
  - 节水优先策略
  - 增产优先策略
  - 平衡策略
- **手动控制开关组**：9个分区阀门的独立控制
- **执行控制按钮**：启动/暂停/停止灌溉任务

#### 5. HUD面板3：成本分析（左下角）
实时显示：
- 本次用水量：xx立方米
- 预估水费：xx元
- 预估电费：xx元
- 总成本：xx元
- 预期收益：xx元/亩

#### 6. AI智能功能
- **智能决策算法**：基于多传感器数据自动制定灌溉策略
- **精准控制系统**：实现分区域、差异化精准灌溉
- **效果实时评估**：动态评估灌溉效果和资源利用率
- **学习优化能力**：系统自动学习优化灌溉策略

---

## 3.3.7 病虫害分析与预测

### 页面目标
AI驱动的病虫害智能监测预警系统，实现从被动治理向主动预防的转变。

### 核心功能设计

#### 1. 筛选器区域
- **时间范围**：近7天/近30天/自定义范围
- **病虫害类型多选**：稻飞虱/玉米螟/纹枯病/稻瘟病等
- **预警等级筛选**：一般/较重/严重/特大
- **数据来源**：田间调查/智能设备/农户上报

#### 2. 动态时空一体化布局
**中间：** GIS地图（60%宽度）
**右侧：** 信息分析面板（40%宽度）
**底部：** 时间轴控制器

#### 3. 关键指标卡片（4个）
- **当前主要病害**：xxx病 <span style="color:red">发生面积xx万亩</span>
- **累计预警次数**：xx次 <span style="color:orange">较同期+xx%</span>
- **AI识别准确率**：xx% <span style="color:lime">基于验证数据</span>
- **预测防控效果**：xx% <span style="color:green">采纳建议后预期</span>

#### 4. GIS地图功能
- **事件点标注**：不同图标表示不同类型病虫害
- **风险圈渲染**：半透明渐变色区域显示扩散风险范围
- **时空动画播放**：拖动时间轴看到病害发生发展过程
- **防控区域标注**：已采取防控措施的区域用绿色边框标注

#### 5. 时间轴控制
- **可拖动滑块**：覆盖筛选器设定的时间范围
- **播放控制**：支持自动播放时空演变过程
- **速度调节**：1x/2x/4x播放速度选择
- **关键时点标注**：重要病害爆发时间节点标注

#### 6. 右侧信息面板
- **当前态势总览**：
  - 主要病害类型
  - 累计影响面积
  - 已发布预警数量
- **发生频率统计**：条形图显示不同病虫害发生次数排序
- **AI预测分析**：
  - 未来7天高发风险区域
  - 扩散趋势预测
  - 推荐防控措施

#### 7. AI智能分析功能
- **病虫害智能识别**：基于图像识别和症状描述AI判断病害类型
- **传播模型预测**：结合气象、地理、作物分布预测扩散趋势
- **防控策略推荐**：AI推荐最优防控时机和药剂配方
- **效果评估反馈**：跟踪防控措施实施效果，优化预测模型

---

## 技术实现要点

### 前端技术栈
- **框架**：Vue 3 + TypeScript + Element Plus
- **地图库**：MapLibre GL JS
- **图表库**：ECharts 5.x
- **3D引擎**：Three.js（智慧灌溉模块）
- **状态管理**：Pinia

### 数据结构设计
- **地理数据**：GeoJSON格式，支持多边形和点数据
- **时序数据**：支持按时间范围查询的JSON格式
- **AI预测结果**：包含置信区间的预测数据结构

### AI能力展示策略
- **预测置信度**：所有预测结果都显示置信区间
- **模型解释性**：关键决策点显示影响因子权重
- **实时学习**：展示模型准确率随时间的提升曲线
- **对比验证**：AI预测结果与实际结果的对比展示

### 性能优化
- **数据懒加载**：大数据集按需加载
- **缓存策略**：预测结果和历史数据缓存
- **3D场景优化**：LOD技术和对象池管理
- **响应式设计**：适配不同分辨率设备